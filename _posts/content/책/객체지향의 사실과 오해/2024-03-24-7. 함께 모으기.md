---
title: "7. 함께 모으기"
date: 2024-03-24
categories: ["책", "객체지향의 사실과 오해"]
tags: ["객체지향의 사실과 오해"]
---

```
코드와 모델을 밀접하게 연관시키는 것은 코드에 의미를 부여하고 모델을 적절하게 한다.
```

마틴 파울러의 UML Distiled에서는 객체지향 설계 안에 존재하는 세 가지 상호 연관된 관점에 대해 설명한다.

##### 개념 관점(Conceptual Perspective)
개념 관점에서 설계는 도메인 안에 존재하는 개념과 개념들 사이의 관계를 표현
<br>
도메인이란 사용자들이 관심을 가지고 있는 특정 분야나 주제를 의미
<br>
소프트웨어는 도메인에 존재하는 문제를 해결하기 위해 개발
<br>
즉, 개념 관점은 사용자가 도메인을 바라보는 관점을 반영, 실제 도메인의 규칙과 제약을 최대한 유사하게 반영하는 것

##### 명세 관점(Specification Perspective)
명세 관점에서 설계는 사용자 영역인 도메인을 벗어나 개발자의 영역이 소프트웨어로 초점을 이동
<br>
실제 소프트웨어에 존재하는 객체들의 책임을 초점으로 맞추고 객체의 인터페이스를 바라본다.
<br>
프로그래머는 객체가 협력을 위해 '무엇'을 할 수 있는가에 초점을 맞춘다.
<br>
인터페이스와 구현을 분리하는 시점. 즉, 인터페이스를 설정하는 시점

##### 구현 관점(Implementation Perspective)
구현 관점에서 설계는 실제 코드를 구현하는 부분과 연관되어 있다.
<br>
프로그래머는 객체의 책임을 '어떻게' 수행할 것인가에 초점을 맞추며 인터페이스를 구현하는데 필요한 속성과 메서드를 클래스에 추가한다.

단, 소프트웨어를 개념 -> 명세 -> 구현 순서로 개발하는 것이 아니라 동일한 클래스를 세 가지 다른 방향에서 바라보는 것을 의미
<br>
클래스가 은유하는 개념은 도메인 관점을 반영, 클래스의 공용 인터페이스는 명세 관점을 반영, 클래스의 속성과 메서드는 구현 관점을 반영
<br>
클래스는 세 가지 관점을 모두 수용할 수 있도록 개념, 인터페이스, 구현을 함께 드러내야 한다.

지금까지 책에서 설명한 방식은 명세 관점에서 주로 설명한 방식

# 커피 전문점 도메인

## 커피 주문
커피 전문점에서 커피를 주문하는 과정을 객체들의 협력 관계로 구현

## 커피 전문점이라는 세상
커피 전문점은 메뉴 항목, 메뉴판, 손님, 바리스타, 커피 객체로 구성
<br>
상태와 무관하게 동일하게 행동할 수 있는 객체는 동일한 타입의 인스턴스로 분류
<br>
이제 객체간의 관계를 파악해야 한다.
<br>
포함, 합성, 연관 관계로 표현 가능하지만 단순하게 관계가 존재하는지만 파악해도 문제는 없음
<br>
타입과 관계를 이용해 추상화한 모델은 소프트웨어가 대상으로 하는 영역인 도메인을 단순화해서 표현한 모델이므로 이를 도메인 모델이라 한다.
<br>
이제 적절한 객체에게 적절한 책임을 할당해야 한다.

# 설계하고 구현하기

## 커피를 주문하기 위한 협력 찾기
객체지향 설계의 첫 번째 목표는 훌륭한 객체를 설계하는 것이 아니라 훌륭한 협력을 설계하는 것.
<br>
훌륭한 객체는 훌륭한 협력을 설계함으로써 얻을 수 있다.
<br>
협력을 설계할 때는 객체가 메시지를 선택하는 것이 아니라 메시지가 객체를 선택해야 한다.
<br>
즉, 메시지를 먼저 선택하고 메시지를 수신하기에 적절한 객체를 선택해야 한다.
<br>
메시지를 수신할 객체는 메시지를 처리할 책임을 맡게 되고 객체가 수신하는 메시지는 외부에 제공하는 공용 인터페이스에 포함된다.

현실속 메뉴판은 자기 스스로 메뉴 항목을 찾지 않지만 소프트웨어 속 메뉴판은 현실 속 메뉴판으로부터 모티브를 따왔을 뿐, 현실 속의 메뉴판보다 더 많은 일을 할 수 있다.
<br>
소프트웨어 객체는 현실 속의 객체를 모방하거나 추상화한 것이 아니라 의미를 쉽게 유추할 수 있도록 '은유'할 뿐이다.

## 인터페이스 정리하기
각 객체를 수신 가능한 메시지만 추려내면 객체의 인터페이스가 된다.
<br>
객체가 어떤 메시지를 수신할 수 있다는 것은 그 객체의 인터페이스 안에 메시지에 해당하는 오퍼레이션이 존재한다는 것을 의미한다.
<br>
객체들을 포괄하는 타입을 정의한 후 식별된 오퍼레이션을 타입의 인터페이스에 추가해야 한다.
<br>
협력을 통해 식별된 오퍼레이션은 외부에서 접근 가능한 public 인터페이스의 일부

## 구현하기
구현 도중에 객체의 인터페이스가 변경될 수 있다.
<br>
구현하지 않고 구상한 설계는 코드로 구현하는 단계에서 대부분 변경된다.
<br>
협력을 구상하는 단계에 너무 오랜 시간을 쏟지 말고 최대한 빨리 코드를 구현해서 설계에 이상이 없는지, 설계가 구현 가능한지를 판단해야 한다.
<br>
코드를 통한 피드백 없이는 깔끔한 설계를 얻을 수 없다.

객체의 속성도 클래스를 구현하는 단계에서 결정될 수 있다.
<br>
객체의 속성은 객체의 내부에 속하기 때문에 캡슐화 되어야 하는데, 캡슐화 된다는 것은 인터페이스에서 객체 내부 속성에 대한 어떤 힌트도 제공되어서는 안된다는 것을 의미
<br>
이를 위해서는 인터페이스를 정하는 단계에서 객체가 어떤 속성을 가지는지, 그 속성이 어떤 자료 구조로 구현됐는지를 고려하지 않는 것이다
<br>
즉, 객체에게 책임을 할당하고 인터페이스를 결정할 때는 가급적 객체 내부의 구현에 대한 어떤 가정도 하지 말아야 한다.
<br>
객체가 어떤 책임을 수행해야 하는지를 결정한 후에야 책임을 수행하는데 필요한 객체의 속성을 결정하라.

인터페이스를 구성하는 오퍼레이션이 구현 단계에서 식별될 수도 있다.
<br>
인터페이스는 객체간 상호작용하는 통로로 인터페이스를 통해 실제로 상호작용을 해보지 않은 채 인터페이스의 모습을 정확하게 예측하는 것은 불가능하다.
<br>
즉, 설계를 간단히 끝내고 최대한 빨리 구현에 돌입하라. 객체의 협력 구조가 보인다면 그대로 코드를 구현하기 시작하라.
<br>
설계가 제대로 그려지지 않는다면 고민하지 말고 실제로 코드를 작성해가면서 협력의 전체적인 밑그림을 그려보아라.
<br>
TDD의 경우 테스트 코드를 작성해가며 협력을 설계한다.

# 코드의 세 가지 관점

## 코드는 세 가지 관점을 모두 제공해야 한다.
소프트웨어 클래스가 도메인 개념의 특성을 최대한 수용한다면 변경을 관리하기 쉽고 유지보수성을 향상시킬 수 있다.

명세 관점은 클래스의 인터페이스를 바라본다.
<br>
공용 인터페이스는 외부의 객체가 해당 객체에 접근할 수 있는 유일한 부분으로, 인터페이스를 수정한다면 해당 객체와 협력하는 모든 객체에 영향을 미칠 수 있음을 유의해야 한다.

구현 관점은 클래스의 내부 구현을 바라본다.
<br>
클래스의 메서드와 속성은 구현에 속하며 공용 인터페이스의 일부가 아니다.
<br>
즉, 원칙적으로 메서드의 구현과 속성의 변경은 외부 객체에 영향을 미쳐서는 안된다.

하나의 클래스 안에 세 가지 관점을 모두 포함하면서도 각 관점에 대응되는 요소를 명확하고 깔끔하게 드러내야 한다.

## 도메인 개념을 참조하는 이유
도메인에 대한 지식을 기반으로 코드의 구조와 의미를 쉽게 유츄할 수 있다.
<br>
이는 시스템의 유지보수성에 커다란 영향을 미친다.
<br>
소프트웨어는 항상 변하고, 설계는 변경을 위해 존재한다.
<br>
여러 개의 클래스로 기능을 분할하고 클래스 안에서 인터페이스와 구현을 분리하는 이유는 변경이 발생했을 때 코드를 좀 더 수월하게 수정하길 바라기 때문이다.
<br>
소프트웨어 클래스가 도메인 개념을 따르면 변화에 쉽게 대응할 수 있다.

## 인터페이스와 구현을 분리하라
명세 관점과 구현 관점이 섞이면 안된다.
<br>
명세 관점은 클래스의 안정적인 측면을 드러내야 한다.
<br>
구현 관점은 클래스의 불안정한 측면을 드러내야 한다.
<br>
개념 관점과 명세 관점 사이는 그렇게 중요하지 않은 경우가 많지만 명세 관점과 구현 관점을 분리하는 것은 매우 중요하다.